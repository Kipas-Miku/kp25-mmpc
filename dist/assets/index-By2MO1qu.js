(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const d of n.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function a(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(o){if(o.ep)return;o.ep=!0;const n=a(o);fetch(o.href,n)}})();const h=void 0,{Player:y}=TextAliveApp,r=new y({app:{token:h},mediaElement:document.querySelector("#media"),mediaBannerPosition:"bottom right"}),f=document.querySelector("#overlay"),l=document.querySelector("#bar"),c=document.querySelector("#text"),u=document.querySelector("#seekbar");u.querySelector("#div");let p,s;r.addListener({onAppReady:e=>{e.managed&&(document.querySelector("#control").className="disable"),e.songUrl||(document.querySelector("#media").className=" disable",r.createFromSongUrl("https://piapro.jp/t/ULcJ/20250205120202"))},onAppMediaChange(){f.ClassName="",l.className="",m()},onVideoReady:e=>{document.querySelector("#artist span").textContent=r.data.song.artist.name,document.querySelector("#song span").textContent=r.data.song.name,s=null;let t=r.video.firstWord;for(;t;)t.animate=C,t=t.next},onTimerReady:()=>{f.className="disabled",document.querySelector("#control > a#play").className="",document.querySelector("#control > a#stop").className=""},onPlay:()=>{const e=document.querySelector("#control > a#play");for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(""))},onPause:()=>{const e=document.querySelector("#control > a#play");for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(""))},onStop:()=>console.log("Play Stop"),onTimeUpdate:e=>{paintedSeekbar.style.width=`${parseInt(e*1e3/r.video.duration)/10}%`;let t=r.findBeat(e);if(p!==t&&(t&&requestAnimationFrame(()=>{l.className="active",requestAnimationFrame(()=>{l.className="active beat"})}),p=t),!r.video.firstChar)return;s&&s.startTime>e+1e3&&m();let a=s||r.video.firstChar;for(;a&&a.startTime<e+500;)s!==a&&(v(a),s=a),a=a.next}});const C=function(e,t){t.contains(e)&&(document.querySelector("#text").textContent=t.text)};u.addEventListener("click",e=>(e.preventDefault(),r&&r.requestMediaSeek(r.video.duration*e.offsetX/u.clientWidth),!1));function v(e){const t=[];(e.parent.pos==="N"||e.parent.pos==="PN"||e.parent.pos==="X")&&t.push("noun"),e.parent.parent.lastChar===e&&t.push("lastChar"),e.parent.language==="en"&&(e.parent.lastChar===e?t.push("lastCharInEnglishWord"):e.parent.firstChar===e&&t.push("firstCharInEnglishWord"));const a=document.createElement("div");a.appendChild(document.createTextNode(e.text));const i=document.createElement("div");i.className=t.join(" "),i.appendChild(a),i.addEventListener("click",()=>{r.requestMediaSeek(e.startTime)}),c.appendChild(i)}function m(){for(s=null;c.firstChild;)c.removeChild(c.firstChild)}document.querySelector("#control > a#play").addEventListener("click",e=>(e.preventDefault(),r&&(r.isPlaying?r.requestPause():r.requestPlay()),!1));document.querySelector("#control > a#stop").addEventListener("click",e=>(e.preventDefault(),r&&(r.requestStop(),l.className="",m()),!1));
